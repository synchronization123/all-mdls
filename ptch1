<!-- Summary Modal -->
<div id="summaryModal" class="modal mid-size-modal" data-z-index="1001">
    <h2>Open Tasks Summary</h2>
    <table>
        <thead>
            <tr>
                <th>Assigned To</th>
                <th>Not Started</th>
                <th>In Progress</th>
                <th>On Hold</th>
            </tr>
        </thead>
        <tbody id="summaryTable"></tbody>
    </table>
    <button class="btn btn-secondary mt-2" onclick="closeModal('summaryModal')">Close</button>
</div>





function showSummaryModal() {
    const summaryData = {};
    
    // Aggregate data from openTasks
    openTasks.forEach(task => {
        const assignedTo = getAssignedToName(task.lead);
        const statusAnalyst = task.status || 'Not Started';
        
        if (!summaryData[assignedTo]) {
            summaryData[assignedTo] = {
                'Not Started': [],
                'In Progress': [],
                'On Hold': []
            };
        }
        if (['Not Started', 'In Progress', 'On Hold'].includes(statusAnalyst)) {
            summaryData[assignedTo][statusAnalyst].push(task.id);
        }
    });

    // Render the summary table
    const tableBody = document.getElementById("summaryTable");
    tableBody.innerHTML = "";
    
    for (const assignedTo in summaryData) {
        const notStartedIds = summaryData[assignedTo]['Not Started'];
        const inProgressIds = summaryData[assignedTo]['In Progress'];
        const onHoldIds = summaryData[assignedTo]['On Hold'];
        
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${assignedTo}</td>
            <td><a href="#" onclick="openEditModalForTasks([${notStartedIds.join(',')}]); return false;">${notStartedIds.length}</a></td>
            <td><a href="#" onclick="openEditModalForTasks([${inProgressIds.join(',')}]); return false;">${inProgressIds.length}</a></td>
            <td><a href="#" onclick="openEditModalForTasks([${onHoldIds.join(',')}]); return false;">${onHoldIds.length}</a></td>
        `;
        tableBody.appendChild(row);
    }
    
    showModal("summaryModal");
}

function openEditModalForTasks(taskIds) {
    if (taskIds.length > 0) {
        // Open the edit modal for the first task in the list
        showEditModal(taskIds[0]);
    }
}