<!-- Summary Modal -->
<div id="summaryModal" class="modal mid-size-modal" data-z-index="1001">
    <h2>Open Tasks Summary</h2>
    <table>
        <thead>
            <tr>
                <th>Assigned To</th>
                <th>Not Started</th>
                <th>In Progress</th>
                <th>On Hold</th>
            </tr>
        </thead>
        <tbody id="summaryTable"></tbody>
    </table>
    <button class="btn btn-secondary mt-2" onclick="closeModal('summaryModal')">Close</button>
</div>



function showSummaryModal() {
    const summaryData = {};
    let totalNotStarted = 0;
    let totalInProgress = 0;
    let totalOnHold = 0;
    
    // Aggregate data from openTasks
    openTasks.forEach(task => {
        const assignedTo = getAssignedToName(task.lead);
        const statusAnalyst = task.status || 'Not Started';
        
        if (!summaryData[assignedTo]) {
            summaryData[assignedTo] = {
                'Not Started': 0,
                'In Progress': 0,
                'On Hold': 0
            };
        }
        if (['Not Started', 'In Progress', 'On Hold'].includes(statusAnalyst)) {
            summaryData[assignedTo][statusAnalyst]++;
            if (statusAnalyst === 'Not Started') totalNotStarted++;
            else if (statusAnalyst === 'In Progress') totalInProgress++;
            else if (statusAnalyst === 'On Hold') totalOnHold++;
        }
    });

    // Render the summary table
    const tableBody = document.getElementById("summaryTable");
    tableBody.innerHTML = "";
    
    for (const assignedTo in summaryData) {
        const notStartedCount = summaryData[assignedTo]['Not Started'];
        const inProgressCount = summaryData[assignedTo]['In Progress'];
        const onHoldCount = summaryData[assignedTo]['On Hold'];
        
        const row = document.createElement("tr");
        row.innerHTML = `
            <td>${assignedTo}</td>
            <td>${notStartedCount}</td>
            <td>${inProgressCount}</td>
            <td>${onHoldCount}</td>
        `;
        tableBody.appendChild(row);
    }

    // Add total row
    const totalRow = document.createElement("tr");
    totalRow.style.fontWeight = "bold";
    totalRow.innerHTML = `
        <td>Total</td>
        <td>${totalNotStarted}</td>
        <td>${totalInProgress}</td>
        <td>${totalOnHold}</td>
    `;
    tableBody.appendChild(totalRow);
    
    showModal("summaryModal");
}